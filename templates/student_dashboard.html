<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SmartSchool - Student Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
html { scroll-behavior: smooth; }
body {
  background: linear-gradient(135deg,#eef9ff,#dbeafe);
  font-family: 'Segoe UI', sans-serif;
  transition: 0.5s;
}
.dark { background:#0f172a; color:white; }

.sidebar {
  position: fixed;
  height: 100vh;
  width: 220px;
  background: #1e293b;
  color: white;
  padding: 20px;
  display: flex;
  flex-direction: column;
}
.sidebar a { color:white; text-decoration:none; margin:15px 0; display:block; }
.sidebar a:hover { color:#38bdf8; }
.logout-btn { margin-top:auto; }

.main { margin-left:220px; padding:25px; }

.card {
  border-radius:20px;
  box-shadow:0 10px 25px rgba(0,0,0,0.12);
  transition:.3s;
}
.card:hover { transform:scale(1.02); }

.hero {
  background: linear-gradient(135deg,#38bdf8,#22c55e);
  color:white;
  padding:30px;
  border-radius:25px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.hero img { width:150px; }
</style>
</head>

<body>

<div class="sidebar">
  <h4>ğŸ« SmartSchool</h4>
  <a href="#dashboard">ğŸ  Dashboard</a>
  <a href="#study">ğŸ“š Study</a>
  <a href="#marks">ğŸ“ Marks</a>
  <a href="#weekly">ğŸ“… Weekly Tests</a>
  <a href="#timetable">ğŸ•’ Timetable</a>

  <button class="btn btn-sm btn-light mt-3" onclick="toggleTheme()">ğŸŒ™ Toggle Mode</button>
  <a href="/logout" class="btn btn-danger btn-sm logout-btn mt-3">Logout</a>
</div>

<div class="main">

<!-- HERO -->
<div class="hero mb-4" id="dashboard">
  <div>
    <h2>Welcome, {{ student_name }} ğŸ‘‹</h2>
    <p>Class {{ student_class }} â€¢ Learn Smart â€¢ Score High</p>
    <p><strong>Attendance:</strong> {{ attendance_percent }}%</p>
  </div>
  <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png">
</div>

<!-- SUBJECT WISE MARKS -->
<div class="card p-4 mb-4" id="marks">
  <h5>ğŸ“ Subject Wise Marks</h5>

  <table class="table table-bordered text-center mt-3">
    <thead class="table-dark">
      <tr>
        <th>Subject</th>
        <th>Internal</th>
        <th>Mid</th>
        <th>Final</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% for m in marks %}
      <tr>
        <td>{{ m.subject }}</td>
        <td>{{ m.internal }}</td>
        <td>{{ m.mid }}</td>
        <td>{{ m.final }}</td>
        <td><strong>{{ m.total }}</strong></td>
      </tr>
      {% else %}
      <tr>
        <td colspan="5" class="text-muted">No marks available yet</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- STUDY MATERIAL -->
<div class="card p-3 mb-4" id="study">
  <h5>ğŸ“š Study Materials</h5>

  {% for n in notes %}
    <div class="mb-2">
      ğŸ“˜ <strong>{{ n.subject }}</strong> - {{ n.chapter }}
      <a href="{{ url_for('static', filename='notes/' + n.file_name) }}" target="_blank">
        View File
      </a>
    </div>
  {% else %}
    <p class="text-muted">Materials uploaded by teachers will appear here.</p>
  {% endfor %}
</div>

<!-- WEEKLY TEST -->
<div class="card p-4 mb-4" id="weekly">
  <h5>ğŸ“… Weekly Tests</h5>

  <table class="table table-bordered">
    <tr>
      <th>Subject</th>
      <th>Marks</th>
    </tr>
    {% for w in weekly_tests %}
    <tr>
      <td>{{ w.subject }}</td>
      <td>{{ w.marks }}</td>
    </tr>
    {% else %}
    <tr>
      <td colspan="2" class="text-muted">Weekly test marks will appear here.</td>
    </tr>
    {% endfor %}
  </table>
</div>

<!-- ANNOUNCEMENTS (UPDATED) -->
<div class="card p-4 mb-4">
  <h5>ğŸ“¢ Class Announcements</h5>

  {% for a in announcements %}
    {% if "Holiday on" in a.message %}
      <div class="alert alert-danger">
        ğŸ‰ <strong>{{ a.message }}</strong>
        {% if a.created_at %}
          <div><small>{{ a.created_at }}</small></div>
        {% endif %}
      </div>
    {% else %}
      <div class="alert alert-info">
        {{ a.message }}
        {% if a.created_at %}
          <div><small>{{ a.created_at }}</small></div>
        {% endif %}
      </div>
    {% endif %}
  {% else %}
    <p class="text-muted">No announcements yet.</p>
  {% endfor %}
</div>

<!-- TIMETABLE -->
<div class="card p-3" id="timetable">
  <h5>ğŸ•’ Class Timetable</h5>

  <table class="table table-bordered">
    <tr>
      <th>Day</th>
      <th>Time</th>
      <th>Subject</th>
    </tr>
    {% for t in timetable %}
    <tr>
      <td>{{ t.day }}</td>
      <td>{{ t.time }}</td>
      <td>{{ t.subject }}</td>
    </tr>
    {% else %}
    <tr>
      <td colspan="3" class="text-muted">Your timetable will appear here.</td>
    </tr>
    {% endfor %}
  </table>
</div>

<!-- HOLIDAYS -->
<div class="card p-4 mt-4">
  <h5>ğŸ– Holidays</h5>

  <table class="table table-bordered">
    <tr>
      <th>Date</th>
      <th>Reason</th>
    </tr>
    {% for h in holidays %}
    <tr>
      <td>{{ h.date }}</td>
      <td>{{ h.reason }}</td>
    </tr>
    {% else %}
    <tr>
      <td colspan="2" class="text-muted">No holidays announced.</td>
    </tr>
    {% endfor %}
  </table>
</div>

</div>

<script>
function toggleTheme(){
  document.body.classList.toggle("dark");
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
